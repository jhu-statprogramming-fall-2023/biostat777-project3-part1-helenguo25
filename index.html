<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Calculate text polarity sentiment at the sentence level and
         optionally aggregate by rows or grouping variable(s).">
<title>Calculate Text Polarity Sentiment • sentimentr</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Calculate Text Polarity Sentiment">
<meta property="og:description" content="Calculate text polarity sentiment at the sentence level and
         optionally aggregate by rows or grouping variable(s).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">sentimentr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/Vignette.html">Vignette</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/trinker/sentimentr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="sentimentr">sentimentr<a class="anchor" aria-label="anchor" href="#sentimentr"></a>
</h1></div>
<p><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/0.1.0/active.svg" alt="Project Status: Active - The project has reached a stable, usable state and is being actively developed."></a> <a href="https://travis-ci.org/trinker/sentimentr" class="external-link"><img src="https://travis-ci.org/trinker/sentimentr.svg?branch=master" alt="Build Status"></a> <a href="https://coveralls.io/github/trinker/sentimentr" class="external-link"><img src="https://coveralls.io/repos/trinker/sentimentr/badge.svg?branch=master" alt="Coverage Status"></a> <a href="https://zenodo.org/badge/latestdoi/5398/trinker/sentimentr" class="external-link"><img src="https://zenodo.org/badge/5398/trinker/sentimentr.svg" alt="DOI"></a> <a href="https://cran.r-project.org/package=sentimentr" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/sentimentr"></a></p>
<p><img src="reference/figures/sentimentr_logo/r_sentimentr.png"></p>
<p><strong>Original github repository: <a href="https://github.com/trinker/sentimentr" class="external-link uri">https://github.com/trinker/sentimentr</a></strong></p>
<p><strong>Package author: Tyler Rinker</strong></p>
<p><strong>Deployed website: <a href="https://https://jhu-statprogramming-fall-2023.github.io/biostat777-project3-part1-helenguo25" class="external-link uri">https://https://jhu-statprogramming-fall-2023.github.io/biostat777-project3-part1-helenguo25</a></strong></p>
<p><strong>Website author: Helen Guo (made website for BSPH140.777 class project)</strong></p>
<p><strong>Pkgdown customization:</strong></p>
<blockquote>
<p>Used ‘minty’ bootswatch theme</p>
</blockquote>
<blockquote>
<p>Used atom-one-light syntax highlighting</p>
</blockquote>
<blockquote>
<p>Specified light navbar</p>
</blockquote>
<blockquote>
<p>Added website contribution to footer</p>
</blockquote>
<blockquote>
<p>Added website contribution to sidebar</p>
</blockquote>
<p><strong>sentimentr</strong> is designed to quickly calculate text polarity sentiment in the English language at the sentence level and optionally aggregate by rows or grouping variable(s).</p>
<p><strong>sentimentr</strong> is a response to my own needs with sentiment detection that were not addressed by the current <strong>R</strong> tools. My own <code>polarity</code> function in the <strong>qdap</strong> package is slower on larger data sets. It is a dictionary lookup approach that tries to incorporate weighting for valence shifters (negation and amplifiers/deamplifiers). Matthew Jockers created the <a href="https://www.matthewjockers.net/2015/02/02/syuzhet/" class="external-link"><strong>syuzhet</strong></a> package that utilizes dictionary lookups for the Bing, NRC, and Afinn methods as well as a custom dictionary. He also utilizes a wrapper for the <a href="http://nlp.stanford.edu/software/corenlp.shtml" class="external-link">Stanford coreNLP</a> which uses much more sophisticated analysis. Jocker’s dictionary methods are fast but are more prone to error in the case of valence shifters. Jocker’s <a href="https://www.matthewjockers.net/2015/03/04/some-thoughts-on-annies-thoughts-about-syuzhet/" class="external-link">addressed these critiques</a> explaining that the method is good with regard to analyzing general sentiment in a piece of literature. He points to the accuracy of the Stanford detection as well. In my own work I need better accuracy than a simple dictionary lookup; something that considers valence shifters yet optimizes speed which the Stanford’s parser does not. This leads to a trade off of speed vs. accuracy. Simply, <strong>sentimentr</strong> attempts to balance accuracy and speed.</p>
</div>
<div class="section level1">
<h1 id="why-sentimentr">Why sentimentr<a class="anchor" aria-label="anchor" href="#why-sentimentr"></a>
</h1>
<p><strong><em>So what does</em></strong> <strong>sentimentr</strong> <strong><em>do that other packages don’t and why does it matter?</em></strong></p>
<blockquote>
<p><strong>sentimentr</strong> attempts to take into account valence shifters (i.e., negators, amplifiers (intensifiers), de-amplifiers (downtoners), and adversative conjunctions) while maintaining speed. Simply put, <strong>sentimentr</strong> is an augmented dictionary lookup. The next questions address why it matters.</p>
</blockquote>
<p><strong><em>So what are these valence shifters?</em></strong></p>
<blockquote>
<p>A <em>negator</em> flips the sign of a polarized word (e.g., “I do <strong><em>not</em></strong> like it.”). See <code>lexicon::hash_valence_shifters[y==1]</code> for examples. An <em>amplifier</em> (intensifier) increases the impact of a polarized word (e.g., “I <strong><em>really</em></strong> like it.”). See <code>lexicon::hash_valence_shifters[y==2]</code> for examples. A <em>de-amplifier</em> (downtoner) reduces the impact of a polarized word (e.g., “I <strong><em>hardly</em></strong> like it.”). See <code>lexicon::hash_valence_shifters[y==3]</code> for examples. An <em>adversative conjunction</em> overrules the previous clause containing a polarized word (e.g., “I like it <strong><em>but</em></strong> it’s not worth it.”). See <code>lexicon::hash_valence_shifters[y==4]</code> for examples.</p>
</blockquote>
<p><strong><em>Do valence shifters really matter?</em></strong></p>
<blockquote>
<p>Well valence shifters affect the polarized words. In the case of <em>negators</em> and <em>adversative conjunctions</em> the entire sentiment of the clause may be reversed or overruled. So if valence shifters occur fairly frequently a simple dictionary lookup may not be modeling the sentiment appropriately. You may be wondering how frequently these valence shifters co-occur with polarized words, potentially changing, or even reversing and overruling the clause’s sentiment. The table below shows the rate of sentence level co-occurrence of valence shifters with polarized words across a few types of texts.</p>
</blockquote>
<table class="table">
<thead><tr class="header">
<th align="left">
Text
</th>
<th align="right">
Negator
</th>
<th align="right">
Amplifier
</th>
<th align="right">
Deamplifier
</th>
<th align="right">
Adversative
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">
Cannon reviews
</td>
<td align="right">
21%
</td>
<td align="right">
23%
</td>
<td align="right">
8%
</td>
<td align="right">
12%
</td>
</tr>
<tr class="even">
<td align="left">
2012 presidential debate
</td>
<td align="right">
23%
</td>
<td align="right">
18%
</td>
<td align="right">
1%
</td>
<td align="right">
11%
</td>
</tr>
<tr class="odd">
<td align="left">
Trump speeches
</td>
<td align="right">
12%
</td>
<td align="right">
14%
</td>
<td align="right">
3%
</td>
<td align="right">
10%
</td>
</tr>
<tr class="even">
<td align="left">
Trump tweets
</td>
<td align="right">
19%
</td>
<td align="right">
18%
</td>
<td align="right">
4%
</td>
<td align="right">
4%
</td>
</tr>
<tr class="odd">
<td align="left">
Dylan songs
</td>
<td align="right">
4%
</td>
<td align="right">
10%
</td>
<td align="right">
0%
</td>
<td align="right">
4%
</td>
</tr>
<tr class="even">
<td align="left">
Austen books
</td>
<td align="right">
21%
</td>
<td align="right">
18%
</td>
<td align="right">
6%
</td>
<td align="right">
11%
</td>
</tr>
<tr class="odd">
<td align="left">
Hamlet
</td>
<td align="right">
26%
</td>
<td align="right">
17%
</td>
<td align="right">
2%
</td>
<td align="right">
16%
</td>
</tr>
</tbody>
</table>
<p>Indeed <em>negators</em> appear ~20% of the time a polarized word appears in a sentence. Conversely, <em>adversative conjunctions</em> appear with polarized words ~10% of the time. Not accounting for the valence shifters could significantly impact the modeling of the text sentiment.</p>
<p>The <a href="https://raw.githubusercontent.com/trinker/sentimentr/master/inst/the_case_for_sentimentr/valence_shifter_cooccurrence_rate.R" class="external-link">script to replicate the frequency analysis</a>, shown in the table above, can be accessed via:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>val_shift_freq <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"the_case_for_sentimentr/valence_shifter_cooccurrence_rate.R"</span>, <span class="at">package =</span> <span class="st">"sentimentr"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">file.copy</span>(val_shift_freq, <span class="fu">getwd</span>())</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="table-of-contents">Table of Contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h1>
<ul>
<li><a href="#why-sentimentr">Why sentimentr</a></li>
<li><a href="#functions">Functions</a></li>
<li><a href="#the-equation">The Equation</a></li>
<li><a href="#installation">Installation</a></li>
<li>
<a href="#examples">Examples</a>
<ul>
<li><a href="#preferred-workflow">Preferred Workflow</a></li>
<li><a href="#tidy-approach">Tidy Approach</a></li>
<li>
<a href="#plotting">Plotting</a>
<ul>
<li><a href="#plotting-at-aggregated-sentiment">Plotting at Aggregated Sentiment</a></li>
<li><a href="#plotting-at-the-sentence-level">Plotting at the Sentence Level</a></li>
</ul>
</li>
<li><a href="#making-and-updating-dictionaries">Making and Updating Dictionaries</a></li>
<li><a href="#annie-swaffords-examples">Annie Swafford’s Examples</a></li>
<li><a href="#comparing-sentimentr-syuzhet-meanr-and-stanford">Comparing sentimentr, syuzhet, meanr, and Stanford</a></li>
<li><a href="#text-highlighting">Text Highlighting</a></li>
</ul>
</li>
<li><a href="#contact">Contact</a></li>
</ul>
</div>
<div class="section level1">
<h1 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h1>
<p>There are two main functions (top 2 in table below) in <strong>sentimentr</strong> with several helper functions summarized in the table below:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="25%">
<col width="74%">
</colgroup>
<thead><tr class="header">
<th>
Function
</th>
<th>
Description
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<code>sentiment</code>
</td>
<td>
Sentiment at the sentence level
</td>
</tr>
<tr class="even">
<td>
<code>sentiment_by</code>
</td>
<td>
Aggregated sentiment by group(s)
</td>
</tr>
<tr class="odd">
<td>
<code>profanity</code>
</td>
<td>
Profanity at the sentence level
</td>
</tr>
<tr class="even">
<td>
<code>profanity_by</code>
</td>
<td>
Aggregated profanity by group(s)
</td>
</tr>
<tr class="odd">
<td>
<code>emotion</code>
</td>
<td>
Emotion at the sentence level
</td>
</tr>
<tr class="even">
<td>
<code>emotion_by</code>
</td>
<td>
Aggregated emotion by group(s)
</td>
</tr>
<tr class="odd">
<td>
<code>uncombine</code>
</td>
<td>
Extract sentence level sentiment from <code>sentiment_by</code>
</td>
</tr>
<tr class="even">
<td>
<code>get_sentences</code>
</td>
<td>
Regex based string to sentence parser (or get sentences from <code>sentiment</code>/<code>sentiment_by</code>)
</td>
</tr>
<tr class="odd">
<td>
<code>replace_emoji</code>
</td>
<td>
repalcement
</td>
</tr>
<tr class="even">
<td>
<code>replace_emoticon</code>
</td>
<td>
Replace emoticons with word equivalent
</td>
</tr>
<tr class="odd">
<td>
<code>replace_grade</code>
</td>
<td>
Replace grades (e.g., "A+") with word equivalent
</td>
</tr>
<tr class="even">
<td>
<code>replace_internet_slang</code>
</td>
<td>
replacment
</td>
</tr>
<tr class="odd">
<td>
<code>replace_rating</code>
</td>
<td>
Replace ratings (e.g., "10 out of 10", "3 stars") with word equivalent
</td>
</tr>
<tr class="even">
<td>
<code>as_key</code>
</td>
<td>
Coerce a <code>data.frame</code> lexicon to a polarity hash key
</td>
</tr>
<tr class="odd">
<td>
<code>is_key</code>
</td>
<td>
Check if an object is a hash key
</td>
</tr>
<tr class="even">
<td>
<code>update_key</code>
</td>
<td>
Add/remove terms to/from a hash key
</td>
</tr>
<tr class="odd">
<td>
<code>highlight</code>
</td>
<td>
Highlight positive/negative sentences as an HTML document
</td>
</tr>
<tr class="even">
<td>
<code>general_rescale</code>
</td>
<td>
Generalized rescaling function to rescale sentiment scoring
</td>
</tr>
<tr class="odd">
<td>
<code>sentiment_attribute</code>
</td>
<td>
Extract the sentiment based attributes from a text
</td>
</tr>
<tr class="even">
<td>
<code>validate_sentiment</code>
</td>
<td>
Validate sentiment score sign against known results
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level1">
<h1 id="the-equation">The Equation<a class="anchor" aria-label="anchor" href="#the-equation"></a>
</h1>
<p>The equation below describes the augmented dictionary method of <strong>sentimentr</strong> that may give better results than a simple lookup dictionary approach that does not consider valence shifters. The equation used by the algorithm to assign value to polarity of each sentence fist utilizes a sentiment dictionary (e.g., Jockers, <a href="https://github.com/mjockers/syuzhet" class="external-link">(2017)</a>) to tag polarized words. Each paragraph (<em>p</em><sub><em>i</em></sub> = {<em>s</em><sub>1</sub>, <em>s</em><sub>2</sub>, …, <em>s</em><sub><em>n</em></sub>}) composed of sentences, is broken into element sentences (<em>s</em><sub><em>i</em></sub>, <em>j</em> = {<em>w</em><sub>1</sub>, <em>w</em><sub>2</sub>, …, <em>w</em><sub><em>n</em></sub>}) where <em>w</em> are the words within sentences. Each sentence (<em>s</em><sub><em>j</em></sub>) is broken into a an ordered bag of words. Punctuation is removed with the exception of pause punctuations (commas, colons, semicolons) which are considered a word within the sentence. I will denote pause words as *c**w* (comma words) for convenience. We can represent these words as an i,j,k notation as <em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub>. For example <em>w</em><sub>3, 2, 5</sub> would be the fifth word of the second sentence of the third paragraph. While I use the term paragraph this merely represent a complete turn of talk. For example it may be a cell level response in a questionnaire composed of sentences.</p>
<p>The words in each sentence (<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub>) are searched and compared to a dictionary of polarized words (e.g., a combined and augmented version of Jocker’s (2017) [originally exported by the <a href="https://github.com/mjockers/syuzhet" class="external-link"><strong>syuzhet</strong></a> package] &amp; Rinker’s augmented Hu &amp; Liu (2004) dictionaries in the <a href="https://cran.r-project.org/package=lexicon" class="external-link"><strong>lexicon</strong></a> package). Positive (<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup>+</sup>) and negative (<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup>−</sup>) words are tagged with a +1 and −1 respectively (or other positive/negative weighting if the user provides the sentiment dictionary). I will denote polarized words as *p**w* for convenience. These will form a polar cluster (<em>c</em><sub><em>i</em>, <em>j</em>, <em>l</em></sub>) which is a subset of the a sentence (<em>c</em><sub><em>i</em>, <em>j</em>, <em>l</em></sub> ⊆ <em>s</em><sub><em>i</em></sub>, <em>j</em>).</p>
<p>The polarized context cluster (<em>c</em><sub><em>i</em>, <em>j</em>, <em>l</em></sub>) of words is pulled from around the polarized word (<em>p<strong>w<em>) and defaults to 4 words before and two words after </em>p</strong>w</em> to be considered as valence shifters. The cluster can be represented as (<em>c</em><sub><em>i</em>, <em>j</em>, <em>l</em></sub> = {<em>p<strong>w<em><sub></sub></em>i<em>, </em>j<em>, </em>k<em> − </em>n</strong>b</em>, …, <em>p<strong>w<em><sub></sub></em>i<em>, </em>j<em>, </em>k<em>, …, </em>p</strong>w</em><sub><em>i</em>, <em>j</em>, <em>k</em> − <em>n<strong>a<em></em></strong></em></sub>}), where nb &amp; *n**a* are the parameters <code>n.before</code> and <code>n.after</code> set by the user. The words in this polarized context cluster are tagged as neutral (<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup>0</sup>), negator (<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>n</em></sup>), amplifier [intensifier] (<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>a</em></sup>), or de-amplifier [downtoner] (<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>d</em></sup>). Neutral words hold no value in the equation but do affect word count (<em>n</em>). Each polarized word is then weighted (<em>w</em>) based on the weights from the <code>polarity_dt</code> argument and then further weighted by the function and number of the valence shifters directly surrounding the positive or negative word (<em>p<strong>w<em>). Pause (</em>c</strong>w</em>) locations (punctuation that denotes a pause including commas, colons, and semicolons) are indexed and considered in calculating the upper and lower bounds in the polarized context cluster. This is because these marks indicate a change in thought and words prior are not necessarily connected with words after these punctuation marks. The lower bound of the polarized context cluster is constrained to max{<em>p<strong>w<em><sub></sub></em>i<em>, </em>j<em>, </em>k<em> − </em>n</strong>b</em>, 1, max{<em>c<strong>w<em><sub></sub></em>i<em>, </em>j<em>, </em>k<em> &lt; </em>p</strong>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub>}} and the upper bound is constrained to min{<em>p<strong>w<em><sub></sub></em>i<em>, </em>j<em>, </em>k<em> + </em>n</strong>a</em>, <em>w</em><sub><em>i</em>, <em>j<strong>n<em></em></strong></em></sub>, min{cw<sub><em>i</em>, <em>j</em>, <em>k</em></sub> &gt; <em>p<strong>w<em><sub></sub></em>i<em>, </em>j<em>, </em>k<em>}} where </em>w<em><sub></sub></em>i<em>, </em>j</strong>n</em> is the number of words in the sentence.</p>
<p>The core value in the cluster, the polarized word is acted upon by valence shifters. Amplifiers increase the polarity by 1.8 (.8 is the default weight (<em>z</em>)). Amplifiers (<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>a</em></sup>) become de-amplifiers if the context cluster contains an odd number of negators (<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>n</em></sup>). De-amplifiers work to decrease the polarity. Negation (<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>n</em></sup>) acts on amplifiers/de-amplifiers as discussed but also flip the sign of the polarized word. Negation is determined by raising −1 to the power of the number of negators (<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>n</em></sup>) plus 2. Simply, this is a result of a belief that two negatives equal a positive, 3 negatives a negative, and so on.</p>
<p>The adversative conjunctions (i.e., ‘but’, ‘however’, and ‘although’) also weight the context cluster. An adversative conjunction before the polarized word (<em>w</em><sub><em>a<strong>d</strong>v<strong>e</strong>r<strong>s</strong>a<strong>t</strong>i<strong>v</strong>e</em> <em>c<strong>o</strong>n<strong>j</strong>u<strong>n</strong>c<strong>t</strong>i<strong>o</strong>n</em></sub>, …, <em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>p</em></sup>) up-weights the cluster by 1 + <em>z</em><sub>2</sub> * {|<em>w</em><sub><em>a<strong>d</strong>v<strong>e</strong>r<strong>s</strong>a<strong>t</strong>i<strong>v</strong>e</em> <em>c<strong>o</strong>n<strong>j</strong>u<strong>n</strong>c<strong>t</strong>i<strong>o</strong>n</em></sub>|,…,<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>p</em></sup>} (.85 is the default weight (<em>z</em><sub>2</sub>) where |<em>w</em><sub><em>a<strong>d</strong>v<strong>e</strong>r<strong>s</strong>a<strong>t</strong>i<strong>v</strong>e</em> <em>c<strong>o</strong>n<strong>j</strong>u<strong>n</strong>c<strong>t</strong>i<strong>o</strong>n</em></sub>| are the number of adversative conjunctions before the polarized word). An adversative conjunction after the polarized word down-weights the cluster by 1 + {<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>p</em></sup>, …, |<em>w</em><sub><em>a<strong>d</strong>v<strong>e</strong>r<strong>s</strong>a<strong>t</strong>i<strong>v</strong>e</em> <em>c<strong>o</strong>n<strong>j</strong>u<strong>n</strong>c<strong>t</strong>i<strong>o</strong>n</em></sub>|* − 1}*<em>z</em><sub>2</sub>. This corresponds to the belief that an adversative conjunction makes the next clause of greater values while lowering the value placed on the prior clause.</p>
<p>The researcher may provide a weight (<em>z</em>) to be utilized with amplifiers/de-amplifiers (default is .8; de-amplifier weight is constrained to −1 lower bound). Last, these weighted context clusters (<em>c</em><sub><em>i</em>, <em>j</em>, <em>l</em></sub>) are summed (<em>c</em>′<sub><em>i</em>, <em>j</em></sub>) and divided by the square root of the word count (√<em>w</em><sub><em>i</em>, *j**n<em></em></sub>) yielding an <strong>unbounded polarity score</strong> (δ<em><sub></sub></em>i<em>, </em>j*) for each sentence.</p>
<p><em>δ</em><sub><em>i<strong>j<em></em></strong></em></sub> = <em>c</em>’<sub>ij</sub>/√<em>w</em><sub><em>i<strong>j</strong>n</em></sub></p>
<p>Where:</p>
<p><em>c</em>′<sub><em>i</em>, <em>j</em></sub> = ∑((1 + <em>w</em><sub><em>a<strong>m</strong>p</em></sub> + <em>w</em><sub><em>d<strong>e</strong>a<strong>m</strong>p</em></sub>)⋅<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>p</em></sup>(−1)<sup>2 + <em>w</em><sub><em>n<strong>e</strong>g</em></sub></sup>)</p>
<p><em>w</em><sub><em>a<strong>m</strong>p</em></sub> = ∑(<em>w</em><sub><em>n<strong>e</strong>g</em></sub> ⋅ (<em>z</em> ⋅ <em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>a</em></sup>))</p>
<p><em>w</em><sub><em>d<strong>e</strong>a<strong>m</strong>p</em></sub> = max(<em>w</em><sub><em>d<strong>e</strong>a<strong>m</strong>p</em>′</sub>, −1)</p>
<p><em>w</em><sub><em>d<strong>e</strong>a<strong>m</strong>p</em>′</sub> = ∑(<em>z</em>(−<em>w</em><sub><em>n<strong>e</strong>g</em></sub> ⋅ <em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>a</em></sup> + <em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>d</em></sup>))</p>
<p><em>w</em><sub><em>b</em></sub> = 1 + <em>z</em><sub>2</sub> * <em>w</em><sub><em>b</em>′</sub></p>
<p><em>w</em><sub><em>b</em>′</sub> = ∑(|<em>w</em><sub><em>a<strong>d</strong>v<strong>e</strong>r<strong>s</strong>a<strong>t</strong>i<strong>v</strong>e</em> <em>c<strong>o</strong>n<strong>j</strong>u<strong>n</strong>c<strong>t</strong>i<strong>o</strong>n</em></sub>|,…,<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>p</em></sup>, <em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>p</em></sup>, …, |<em>w</em><sub><em>a<strong>d</strong>v<strong>e</strong>r<strong>s</strong>a<strong>t</strong>i<strong>v</strong>e</em> <em>c<strong>o</strong>n<strong>j</strong>u<strong>n</strong>c<strong>t</strong>i<strong>o</strong>n</em></sub>|* − 1)</p>
<p><em>w</em><sub><em>n<strong>e</strong>g</em></sub> = (∑<em>w</em><sub><em>i</em>, <em>j</em>, <em>k</em></sub><sup><em>n</em></sup> ) mod 2</p>
<p>To get the mean of all sentences (<em>s</em><sub><em>i</em>, <em>j</em></sub>) within a paragraph/turn of talk (<em>p</em><sub><em>i</em></sub>) simply take the average sentiment score <em>p</em><sub><em>i</em>, <em>δ</em><sub><em>i</em>, <em>j</em></sub></sub> = 1/n ⋅ ∑ <em>δ</em><sub><em>i</em>, <em>j</em></sub> or use an available weighted average (the default <code>average_weighted_mixed_sentiment</code> which upweights the negative values in a vector while also downweighting the zeros in a vector or <code>average_downweighted_zero</code> which simply downweights the zero polarity scores).</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>To download the development version of <strong>sentimentr</strong>:</p>
<p>Download the <a href="https://github.com/trinker/sentimentr/zipball/master" class="external-link">zip ball</a> or <a href="https://github.com/trinker/sentimentr/tarball/master" class="external-link">tar ball</a>, decompress and run <code>R CMD INSTALL</code> on it, or use the <strong>pacman</strong> package to install the development version:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load_current_gh</span>(<span class="st">"trinker/lexicon"</span>, <span class="st">"trinker/sentimentr"</span>)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sentimentr, dplyr, magrittr)</span></code></pre></div>
<div class="section level2">
<h2 id="preferred-workflow">Preferred Workflow<a class="anchor" aria-label="anchor" href="#preferred-workflow"></a>
</h2>
<p>Here is a basic <code>sentiment</code> demo. Notice that the first thing you should do is to split your text data into sentences (a process called sentence boundary disambiguation) via the <code>get_sentences</code> function. This can be handled within <code>sentiment</code> (i.e., you can pass a raw character vector) but it slows the function down and should be done one time rather than every time the function is called. Additionally, a warning will be thrown if a larger raw character vector is passed. The preferred workflow is to spit the text into sentences with <code>get_sentences</code> before any sentiment analysis is done.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>mytext <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>    <span class="st">'do you like it?  But I hate really bad dogs'</span>,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>    <span class="st">'I am the best friend.'</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>    <span class="st">'Do you really like it?  I</span><span class="sc">\'</span><span class="st">m not a fan'</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>mytext <span class="ot">&lt;-</span> <span class="fu">get_sentences</span>(mytext)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="fu">sentiment</span>(mytext)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="do">##    element_id sentence_id word_count  sentiment</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="do">## 1:          1           1          4  0.2500000</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="do">## 2:          1           2          6 -1.8677359</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="do">## 3:          2           1          5  0.5813777</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="do">## 4:          3           1          5  0.4024922</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="do">## 5:          3           2          4  0.0000000</span></span></code></pre></div>
<p>To aggregate by element (column cell or vector element) use <code>sentiment_by</code> with <code>by = NULL</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>mytext <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>    <span class="st">'do you like it?  But I hate really bad dogs'</span>,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="st">'I am the best friend.'</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="st">'Do you really like it?  I</span><span class="sc">\'</span><span class="st">m not a fan'</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>mytext <span class="ot">&lt;-</span> <span class="fu">get_sentences</span>(mytext)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="fu">sentiment_by</span>(mytext)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="do">##    element_id word_count       sd ave_sentiment</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="do">## 1:          1         10 1.497465    -0.8088680</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="do">## 2:          2          5       NA     0.5813777</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="do">## 3:          3          9 0.284605     0.2196345</span></span></code></pre></div>
<p>To aggregate by grouping variables use <code>sentiment_by</code> using the <code>by</code> argument.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>(out <span class="ot">&lt;-</span> <span class="fu">with</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>    presidential_debates_2012, </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    <span class="fu">sentiment_by</span>(</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>        <span class="fu">get_sentences</span>(dialogue), </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>        <span class="fu">list</span>(person, time)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>    )</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>))</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="do">##        person   time word_count        sd ave_sentiment</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="do">##  1:     OBAMA time 1       3599 0.2535006    0.12256892</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="do">##  2:     OBAMA time 2       7477 0.2509177    0.11217673</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="do">##  3:     OBAMA time 3       7243 0.2441394    0.07975688</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="do">##  4:    ROMNEY time 1       4085 0.2525596    0.10151917</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="do">##  5:    ROMNEY time 2       7536 0.2205169    0.08791018</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="do">##  6:    ROMNEY time 3       8303 0.2623534    0.09968544</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="do">##  7:   CROWLEY time 2       1672 0.2181662    0.19455290</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="do">##  8:    LEHRER time 1        765 0.2973360    0.15473364</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="do">##  9:  QUESTION time 2        583 0.1756778    0.03197751</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="do">## 10: SCHIEFFER time 3       1445 0.2345187    0.08843478</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="tidy-approach">Tidy Approach<a class="anchor" aria-label="anchor" href="#tidy-approach"></a>
</h2>
<p>Or if you prefer a more tidy approach:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>presidential_debates_2012 <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dialogue_split =</span> <span class="fu">get_sentences</span>(dialogue)) <span class="sc">%$%</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    <span class="fu">sentiment_by</span>(dialogue_split, <span class="fu">list</span>(person, time))</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="do">##        person   time word_count        sd ave_sentiment</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="do">##  1:     OBAMA time 1       3599 0.2535006    0.12256892</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="do">##  2:     OBAMA time 2       7477 0.2509177    0.11217673</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="do">##  3:     OBAMA time 3       7243 0.2441394    0.07975688</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="do">##  4:    ROMNEY time 1       4085 0.2525596    0.10151917</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="do">##  5:    ROMNEY time 2       7536 0.2205169    0.08791018</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="do">##  6:    ROMNEY time 3       8303 0.2623534    0.09968544</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="do">##  7:   CROWLEY time 2       1672 0.2181662    0.19455290</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="do">##  8:    LEHRER time 1        765 0.2973360    0.15473364</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="do">##  9:  QUESTION time 2        583 0.1756778    0.03197751</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="do">## 10: SCHIEFFER time 3       1445 0.2345187    0.08843478</span></span></code></pre></div>
<p>Note that you can skip the <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate</a></code> step by using <code>get_sentences</code> on a <code>data.frame</code> as seen below:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>presidential_debates_2012 <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>    <span class="fu">get_sentences</span>() <span class="sc">%$%</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    <span class="fu">sentiment_by</span>(dialogue, <span class="fu">list</span>(person, time))</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="do">##        person   time word_count        sd ave_sentiment</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="do">##  1:     OBAMA time 1       3599 0.2535006    0.12256892</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="do">##  2:     OBAMA time 2       7477 0.2509177    0.11217673</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="do">##  3:     OBAMA time 3       7243 0.2441394    0.07975688</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="do">##  4:    ROMNEY time 1       4085 0.2525596    0.10151917</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="do">##  5:    ROMNEY time 2       7536 0.2205169    0.08791018</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="do">##  6:    ROMNEY time 3       8303 0.2623534    0.09968544</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="do">##  7:   CROWLEY time 2       1672 0.2181662    0.19455290</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="do">##  8:    LEHRER time 1        765 0.2973360    0.15473364</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="do">##  9:  QUESTION time 2        583 0.1756778    0.03197751</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="do">## 10: SCHIEFFER time 3       1445 0.2345187    0.08843478</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h2>
<div class="section level3">
<h3 id="plotting-at-aggregated-sentiment">Plotting at Aggregated Sentiment<a class="anchor" aria-label="anchor" href="#plotting-at-aggregated-sentiment"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(out)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-11-1.png"></p>
</div>
<div class="section level3">
<h3 id="plotting-at-the-sentence-level">Plotting at the Sentence Level<a class="anchor" aria-label="anchor" href="#plotting-at-the-sentence-level"></a>
</h3>
<p>The <code>plot</code> method for the class <code>sentiment</code> uses <strong>syuzhet</strong>’s <code>get_transformed_values</code> combined with <strong>ggplot2</strong> to make a reasonable, smoothed plot for the duration of the text based on percentage, allowing for comparison between plots of different texts. This plot gives the overall shape of the text’s sentiment. The user can see <code><a href="https://rdrr.io/pkg/syuzhet/man/get_transformed_values.html" class="external-link">syuzhet::get_transformed_values</a></code> for more details.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">uncombine</span>(out))</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-12-1.png"></p>
</div>
</div>
<div class="section level2">
<h2 id="making-and-updating-dictionaries">Making and Updating Dictionaries<a class="anchor" aria-label="anchor" href="#making-and-updating-dictionaries"></a>
</h2>
<p>It is pretty straight forward to make or update a new dictionary (polarity or valence shifter). To create a key from scratch the user needs to create a 2 column <code>data.frame</code>, with words on the left and values on the right (see <code><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_jockers_rinker.html" class="external-link">?lexicon::hash_sentiment_jockers_rinker</a></code> &amp; <code><a href="https://rdrr.io/pkg/lexicon/man/hash_valence_shifters.html" class="external-link">?lexicon::hash_valence_shifters</a></code> for what the values mean). Note that the words need to be lower cased. Here I show an example <code>data.frame</code> ready for key conversion:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>key <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>    <span class="at">words =</span> <span class="fu">sample</span>(letters),</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>    <span class="at">polarity =</span> <span class="fu">rnorm</span>(<span class="dv">26</span>),</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>)</span></code></pre></div>
<p>This is not yet a key. <strong>sentimentr</strong> provides the <code>is_key</code> function to test if a table is a key.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">is_key</span>(key)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="do">## [1] FALSE</span></span></code></pre></div>
<p>It still needs to be <strong>data.table</strong>-ified. The <code>as_key</code> function coerces a <code>data.frame</code> to a <strong>data.table</strong> with the left column named <code>x</code> and the right column named <code>y</code>. It also checks the key against another key to make sure there is not overlap using the <code>compare</code> argument. By default <code>as_key</code> checks against <code>valence_shifters_table</code>, assuming the user is creating a sentiment dictionary. If the user is creating a valence shifter key then a sentiment key needs to be passed to <code>compare</code> instead and set the argument <code>sentiment = FALSE</code>. Below I coerce <code>key</code> to a dictionary that <strong>sentimentr</strong> can use.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>mykey <span class="ot">&lt;-</span> <span class="fu">as_key</span>(key)</span></code></pre></div>
<p>Now we can check that <code>mykey</code> is a usable dictionary:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">is_key</span>(mykey)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="do">## [1] TRUE</span></span></code></pre></div>
<p>The key is ready for use:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">sentiment_by</span>(<span class="st">"I am a human."</span>, <span class="at">polarity_dt =</span> mykey)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="do">##    element_id word_count sd ave_sentiment</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="do">## 1:          1          4 NA    -0.7594893</span></span></code></pre></div>
<p>You can see the values of a key that correspond to a word using <strong>data.table</strong> syntax:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>mykey[<span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>)][[<span class="dv">2</span>]]</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="do">## [1] -0.2537805 -0.1951504</span></span></code></pre></div>
<p>Updating (adding or removing terms) a key is also useful. The <code>update_key</code> function allows the user to add or drop terms via the <code>x</code> (add a <code>data.frame</code>) and <code>drop</code> (drop a term) arguments. Below I drop the “a” and “h” terms (notice there are now 24 rows rather than 26):</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>mykey_dropped <span class="ot">&lt;-</span> <span class="fu">update_key</span>(mykey, <span class="at">drop =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"h"</span>))</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">nrow</span>(mykey_dropped)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="do">## [1] 24</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="fu">sentiment_by</span>(<span class="st">"I am a human."</span>, <span class="at">polarity_dt =</span> mykey_dropped)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="do">##    element_id word_count sd ave_sentiment</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="do">## 1:          1          4 NA     -0.632599</span></span></code></pre></div>
<p>Next I add the terms “dog” and “cat” as a <code>data.frame</code> with sentiment values:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>mykey_added <span class="ot">&lt;-</span> <span class="fu">update_key</span>(mykey, <span class="at">x =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">"dog"</span>, <span class="st">"cat"</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="do">## Warning in as_key(x, comparison = comparison, sentiment = sentiment): Column 1 was a factor...</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="do">## Converting to character.</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="fu">nrow</span>(mykey_added)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="do">## [1] 28</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="fu">sentiment</span>(<span class="st">"I am a human. The dog.  The cat"</span>, <span class="at">polarity_dt =</span> mykey_added)</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="do">##    element_id sentence_id word_count  sentiment</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="do">## 1:          1           1          4 -0.7594893</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="do">## 2:          1           2          2  0.7071068</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="do">## 3:          1           3          2 -0.7071068</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="annie-swaffords-examples">Annie Swafford’s Examples<a class="anchor" aria-label="anchor" href="#annie-swaffords-examples"></a>
</h2>
<p><a href="https://annieswafford.wordpress.com/2015/03/02/syuzhet/" class="external-link">Annie Swafford</a> critiqued Jocker’s approach to sentiment and gave the following examples of sentences (<code>ase</code> for Annie Swafford example). Here I test each of Jocker’s 4 dictionary approaches (syuzhet, Bing, NRC, Afinn), his Stanford wrapper (note I use my own <a href="https://github.com/trinker/stansent" class="external-link">GitHub Stanford wrapper package</a> based off of Jocker’s approach as it works more reliably on my own Windows machine), the <a href="https://cran.r-project.org/package=RSentiment" class="external-link">RSentiment</a> package, the lookup based <a href="https://github.com/sfeuerriegel/SentimentAnalysis" class="external-link">SentimentAnalysis</a> package, the <a href="https://github.com/wrathematics/meanr" class="external-link">meanr</a> package (written in C level code), and my own algorithm with default combined Jockers (2017) &amp; Rinker’s augmented Hu &amp; Liu (2004) polarity lexicons as well as Hu &amp; Liu (2004) and Baccianella, Esuli and Sebastiani’s (2010) SentiWord lexicons available from the <a href="https://github.com/trinker/lexicon" class="external-link"><strong>lexicon</strong></a> package.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"pacman"</span>)) <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load_gh</span>(<span class="st">"trinker/sentimentr"</span>, <span class="st">"trinker/stansent"</span>, <span class="st">"sfeuerriegel/SentimentAnalysis"</span>, <span class="st">"wrathematics/meanr"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(syuzhet, qdap, microbenchmark, RSentiment)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>ase <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>    <span class="st">"I haven't been sad in a long time."</span>,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>    <span class="st">"I am extremely happy today."</span>,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>    <span class="st">"It's a good day."</span>,</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>    <span class="st">"But suddenly I'm only a little bit happy."</span>,</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>    <span class="st">"Then I'm not happy at all."</span>,</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>    <span class="st">"In fact, I am now the least happy person on the planet."</span>,</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>    <span class="st">"There is no happiness left in me."</span>,</span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>    <span class="st">"Wait, it's returned!"</span>,</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>    <span class="st">"I don't feel so bad after all!"</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>)</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>syuzhet <span class="ot">&lt;-</span> <span class="fu">setNames</span>(<span class="fu">as.data.frame</span>(<span class="fu">lapply</span>(<span class="fu">c</span>(<span class="st">"syuzhet"</span>, <span class="st">"bing"</span>, <span class="st">"afinn"</span>, <span class="st">"nrc"</span>),</span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a>    <span class="cf">function</span>(x) <span class="fu">get_sentiment</span>(ase, <span class="at">method=</span>x))), <span class="fu">c</span>(<span class="st">"jockers"</span>, <span class="st">"bing"</span>, <span class="st">"afinn"</span>, <span class="st">"nrc"</span>))</span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>SentimentAnalysis <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">analyzeSentiment</span>(ase)[<span class="fu">c</span>(<span class="st">'SentimentGI'</span>, <span class="st">'SentimentLM'</span>, <span class="st">'SentimentQDAP'</span>) ], <span class="dv">2</span>, round, <span class="dv">2</span>)</span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a><span class="fu">colnames</span>(SentimentAnalysis) <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'^Sentiment'</span>, <span class="st">"SA_"</span>, <span class="fu">colnames</span>(SentimentAnalysis))</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a><span class="fu">left_just</span>(<span class="fu">data.frame</span>(</span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a>    <span class="at">stanford =</span> <span class="fu">sentiment_stanford</span>(ase)[[<span class="st">"sentiment"</span>]],</span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a>    <span class="at">sentimentr_jockers_rinker =</span> <span class="fu">round</span>(<span class="fu">sentiment</span>(ase, <span class="at">question.weight =</span> <span class="dv">0</span>)[[<span class="st">"sentiment"</span>]], <span class="dv">2</span>),</span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a>    <span class="at">sentimentr_jockers =</span> <span class="fu">round</span>(<span class="fu">sentiment</span>(ase, lexicon<span class="sc">::</span>hash_sentiment_jockers, <span class="at">question.weight =</span> <span class="dv">0</span>)[[<span class="st">"sentiment"</span>]], <span class="dv">2</span>),    </span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a>    <span class="at">sentimentr_huliu =</span> <span class="fu">round</span>(<span class="fu">sentiment</span>(ase, lexicon<span class="sc">::</span>hash_sentiment_huliu, <span class="at">question.weight =</span> <span class="dv">0</span>)[[<span class="st">"sentiment"</span>]], <span class="dv">2</span>),    </span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a>    <span class="at">sentimentr_sentiword =</span> <span class="fu">round</span>(<span class="fu">sentiment</span>(ase, lexicon<span class="sc">::</span>hash_sentiment_sentiword, <span class="at">question.weight =</span> <span class="dv">0</span>)[[<span class="st">"sentiment"</span>]], <span class="dv">2</span>),    </span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a>    <span class="at">RSentiment =</span> <span class="fu">calculate_score</span>(ase), </span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a>    SentimentAnalysis,</span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a>    <span class="at">meanr =</span> <span class="fu">score</span>(ase)[[<span class="st">'score'</span>]],</span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a>    syuzhet,</span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a>    <span class="at">sentences =</span> ase,</span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a>    <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a>), <span class="st">"sentences"</span>)</span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a></span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Processing sentence: i have not been sad in a long time"</span></span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Processing sentence: i am extremely happy today"</span></span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Processing sentence: its a good day"</span></span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Processing sentence: but suddenly im only a little bit happy"</span></span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Processing sentence: then im not happy at all"</span></span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Processing sentence: in fact i am now the least happy person on the planet"</span></span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Processing sentence: there is no happiness left in me"</span></span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Processing sentence: wait its returned"</span></span>
<span id="cb19-45"><a href="#cb19-45" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">"Processing sentence: i do not feel so bad after all"</span></span>
<span id="cb19-46"><a href="#cb19-46" tabindex="-1"></a></span>
<span id="cb19-47"><a href="#cb19-47" tabindex="-1"></a>  stanford sentimentr_jockers_rinker sentimentr_jockers sentimentr_huliu</span>
<span id="cb19-48"><a href="#cb19-48" tabindex="-1"></a><span class="dv">1</span>     <span class="sc">-</span><span class="fl">0.5</span>                      <span class="fl">0.18</span>               <span class="fl">0.18</span>             <span class="fl">0.35</span></span>
<span id="cb19-49"><a href="#cb19-49" tabindex="-1"></a><span class="dv">2</span>        <span class="dv">1</span>                       <span class="fl">0.6</span>                <span class="fl">0.6</span>              <span class="fl">0.8</span></span>
<span id="cb19-50"><a href="#cb19-50" tabindex="-1"></a><span class="dv">3</span>      <span class="fl">0.5</span>                      <span class="fl">0.38</span>               <span class="fl">0.38</span>              <span class="fl">0.5</span></span>
<span id="cb19-51"><a href="#cb19-51" tabindex="-1"></a><span class="dv">4</span>     <span class="sc">-</span><span class="fl">0.5</span>                         <span class="dv">0</span>                  <span class="dv">0</span>                <span class="dv">0</span></span>
<span id="cb19-52"><a href="#cb19-52" tabindex="-1"></a><span class="dv">5</span>     <span class="sc">-</span><span class="fl">0.5</span>                     <span class="sc">-</span><span class="fl">0.31</span>              <span class="sc">-</span><span class="fl">0.31</span>            <span class="sc">-</span><span class="fl">0.41</span></span>
<span id="cb19-53"><a href="#cb19-53" tabindex="-1"></a><span class="dv">6</span>     <span class="sc">-</span><span class="fl">0.5</span>                      <span class="fl">0.04</span>               <span class="fl">0.04</span>             <span class="fl">0.06</span></span>
<span id="cb19-54"><a href="#cb19-54" tabindex="-1"></a><span class="dv">7</span>     <span class="sc">-</span><span class="fl">0.5</span>                     <span class="sc">-</span><span class="fl">0.28</span>              <span class="sc">-</span><span class="fl">0.28</span>            <span class="sc">-</span><span class="fl">0.38</span></span>
<span id="cb19-55"><a href="#cb19-55" tabindex="-1"></a><span class="dv">8</span>        <span class="dv">0</span>                     <span class="sc">-</span><span class="fl">0.14</span>              <span class="sc">-</span><span class="fl">0.14</span>                <span class="dv">0</span></span>
<span id="cb19-56"><a href="#cb19-56" tabindex="-1"></a><span class="dv">9</span>     <span class="sc">-</span><span class="fl">0.5</span>                      <span class="fl">0.28</span>               <span class="fl">0.28</span>             <span class="fl">0.38</span></span>
<span id="cb19-57"><a href="#cb19-57" tabindex="-1"></a>  sentimentr_sentiword RSentiment SA_GI SA_LM SA_QDAP meanr jockers bing</span>
<span id="cb19-58"><a href="#cb19-58" tabindex="-1"></a><span class="dv">1</span>                 <span class="fl">0.18</span>          <span class="dv">1</span> <span class="sc">-</span><span class="fl">0.25</span>     <span class="dv">0</span>   <span class="sc">-</span><span class="fl">0.25</span>    <span class="sc">-</span><span class="dv">1</span>    <span class="sc">-</span><span class="fl">0.5</span>   <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb19-59"><a href="#cb19-59" tabindex="-1"></a><span class="dv">2</span>                 <span class="fl">0.65</span>          <span class="dv">1</span>  <span class="fl">0.33</span>  <span class="fl">0.33</span>       <span class="dv">0</span>     <span class="dv">1</span>    <span class="fl">0.75</span>    <span class="dv">1</span></span>
<span id="cb19-60"><a href="#cb19-60" tabindex="-1"></a><span class="dv">3</span>                 <span class="fl">0.32</span>          <span class="dv">1</span>   <span class="fl">0.5</span>   <span class="fl">0.5</span>     <span class="fl">0.5</span>     <span class="dv">1</span>    <span class="fl">0.75</span>    <span class="dv">1</span></span>
<span id="cb19-61"><a href="#cb19-61" tabindex="-1"></a><span class="dv">4</span>                    <span class="dv">0</span>          <span class="dv">0</span>     <span class="dv">0</span>  <span class="fl">0.25</span>    <span class="fl">0.25</span>     <span class="dv">1</span>    <span class="fl">0.75</span>    <span class="dv">1</span></span>
<span id="cb19-62"><a href="#cb19-62" tabindex="-1"></a><span class="dv">5</span>                <span class="sc">-</span><span class="fl">0.56</span>         <span class="sc">-</span><span class="dv">1</span>     <span class="dv">1</span>     <span class="dv">1</span>       <span class="dv">1</span>     <span class="dv">1</span>    <span class="fl">0.75</span>    <span class="dv">1</span></span>
<span id="cb19-63"><a href="#cb19-63" tabindex="-1"></a><span class="dv">6</span>                 <span class="fl">0.11</span>          <span class="dv">1</span>  <span class="fl">0.17</span>  <span class="fl">0.17</span>    <span class="fl">0.33</span>     <span class="dv">1</span>    <span class="fl">0.75</span>    <span class="dv">1</span></span>
<span id="cb19-64"><a href="#cb19-64" tabindex="-1"></a><span class="dv">7</span>                <span class="sc">-</span><span class="fl">0.05</span>          <span class="dv">1</span>   <span class="fl">0.5</span>   <span class="fl">0.5</span>     <span class="fl">0.5</span>     <span class="dv">1</span>    <span class="fl">0.75</span>    <span class="dv">1</span></span>
<span id="cb19-65"><a href="#cb19-65" tabindex="-1"></a><span class="dv">8</span>                <span class="sc">-</span><span class="fl">0.14</span>         <span class="sc">-</span><span class="dv">1</span>     <span class="dv">0</span>     <span class="dv">0</span>       <span class="dv">0</span>     <span class="dv">0</span>   <span class="sc">-</span><span class="fl">0.25</span>    <span class="dv">0</span></span>
<span id="cb19-66"><a href="#cb19-66" tabindex="-1"></a><span class="dv">9</span>                 <span class="fl">0.24</span>          <span class="dv">0</span> <span class="sc">-</span><span class="fl">0.33</span> <span class="sc">-</span><span class="fl">0.33</span>   <span class="sc">-</span><span class="fl">0.33</span>    <span class="sc">-</span><span class="dv">1</span>   <span class="sc">-</span><span class="fl">0.75</span>   <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb19-67"><a href="#cb19-67" tabindex="-1"></a>  afinn nrc sentences                                              </span>
<span id="cb19-68"><a href="#cb19-68" tabindex="-1"></a><span class="dv">1</span>    <span class="sc">-</span><span class="dv">2</span>   <span class="dv">0</span> I haven<span class="st">'t been sad in a long time.                     </span></span>
<span id="cb19-69"><a href="#cb19-69" tabindex="-1"></a><span class="st">2     3   1 I am extremely happy today.                            </span></span>
<span id="cb19-70"><a href="#cb19-70" tabindex="-1"></a><span class="st">3     3   1 It'</span>s a good day.                                       </span>
<span id="cb19-71"><a href="#cb19-71" tabindex="-1"></a><span class="dv">4</span>     <span class="dv">3</span>   <span class="dv">1</span> But suddenly I<span class="st">'m only a little bit happy.              </span></span>
<span id="cb19-72"><a href="#cb19-72" tabindex="-1"></a><span class="st">5     3   1 Then I'</span>m not happy at all.                             </span>
<span id="cb19-73"><a href="#cb19-73" tabindex="-1"></a><span class="dv">6</span>     <span class="dv">3</span>   <span class="dv">1</span> In fact, I am now the least happy person on the planet.</span>
<span id="cb19-74"><a href="#cb19-74" tabindex="-1"></a><span class="dv">7</span>     <span class="dv">2</span>   <span class="dv">1</span> There is no happiness left <span class="cf">in</span> me.                      </span>
<span id="cb19-75"><a href="#cb19-75" tabindex="-1"></a><span class="dv">8</span>     <span class="dv">0</span>  <span class="sc">-</span><span class="dv">1</span> Wait, it<span class="st">'s returned!                                   </span></span>
<span id="cb19-76"><a href="#cb19-76" tabindex="-1"></a><span class="st">9    -3  -1 I don'</span>t feel so bad after all<span class="sc">!</span>                         </span></code></pre></div>
<p>Also of interest is the computational time used by each of these methods. To demonstrate this I increased Annie’s examples by 100 replications and <strong>microbenchmark</strong> on a few iterations (Stanford takes so long I didn’t extend to more). Note that if a text needs to be broken into sentence parts <strong>syuzhet</strong> has the <code>get_sentences</code> function that uses the <strong>openNLP</strong> package, this is a time expensive task. <strong>sentimentr</strong> uses a much faster regex based approach that is nearly as accurate in parsing sentences with a much lower computational time. We see that <strong>RSentiment</strong> and Stanford take the longest time while <strong>sentimentr</strong> and <strong>syuzhet</strong> are comparable depending upon lexicon used. <strong>meanr</strong> is lighting fast. <strong>SentimentAnalysis</strong> is a bit slower than other methods but is returning 3 scores from 3 different dictionaries. I do not test <strong>RSentiment</strong> because it causes an out of memory error.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>ase_100 <span class="ot">&lt;-</span> <span class="fu">rep</span>(ase, <span class="dv">100</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a> </span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>stanford <span class="ot">&lt;-</span> <span class="cf">function</span>() {<span class="fu">sentiment_stanford</span>(ase_100)}</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>sentimentr_jockers_rinker <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sentiment</span>(ase_100, lexicon<span class="sc">::</span>hash_sentiment_jockers_rinker)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>sentimentr_jockers <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sentiment</span>(ase_100, lexicon<span class="sc">::</span>hash_sentiment_jockers)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>sentimentr_huliu <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sentiment</span>(ase_100, lexicon<span class="sc">::</span>hash_sentiment_huliu)</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>sentimentr_sentiword <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">sentiment</span>(ase_100, lexicon<span class="sc">::</span>hash_sentiment_sentiword) </span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>    </span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>RSentiment <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">calculate_score</span>(ase_100) </span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>    </span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>SentimentAnalysis <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">analyzeSentiment</span>(ase_100)</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>meanr <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">score</span>(ase_100)</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>syuzhet_jockers <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">get_sentiment</span>(ase_100, <span class="at">method=</span><span class="st">"syuzhet"</span>)</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>syuzhet_binn <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">get_sentiment</span>(ase_100, <span class="at">method=</span><span class="st">"bing"</span>)</span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>syuzhet_nrc <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">get_sentiment</span>(ase_100, <span class="at">method=</span><span class="st">"nrc"</span>)</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>syuzhet_afinn <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">get_sentiment</span>(ase_100, <span class="at">method=</span><span class="st">"afinn"</span>)</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>     </span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a><span class="fu">microbenchmark</span>(</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>    <span class="fu">stanford</span>(),</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>    <span class="fu">sentimentr_jockers_rinker</span>(),</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>    <span class="fu">sentimentr_jockers</span>(),</span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>    <span class="fu">sentimentr_huliu</span>(),</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>    <span class="fu">sentimentr_sentiword</span>(),</span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a>    <span class="co">#RSentiment(), </span></span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a>    <span class="fu">SentimentAnalysis</span>(),</span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a>    <span class="fu">syuzhet_jockers</span>(),</span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a>    <span class="fu">syuzhet_binn</span>(), </span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a>    <span class="fu">syuzhet_nrc</span>(),</span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a>    <span class="fu">syuzhet_afinn</span>(),</span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a>    <span class="fu">meanr</span>(),</span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a>    <span class="at">times =</span> <span class="dv">3</span></span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a>)</span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a></span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a>Unit<span class="sc">:</span> milliseconds</span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a>                        expr          min           lq         mean</span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a>                  <span class="fu">stanford</span>() <span class="fl">20225.158418</span> <span class="fl">20609.912899</span> <span class="fl">23748.607689</span></span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a> <span class="fu">sentimentr_jockers_rinker</span>()   <span class="fl">283.271569</span>   <span class="fl">283.391307</span>   <span class="fl">285.273047</span></span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a>        <span class="fu">sentimentr_jockers</span>()   <span class="fl">224.436569</span>   <span class="fl">228.487136</span>   <span class="fl">235.022980</span></span>
<span id="cb20-42"><a href="#cb20-42" tabindex="-1"></a>          <span class="fu">sentimentr_huliu</span>()   <span class="fl">255.438460</span>   <span class="fl">260.156352</span>   <span class="fl">261.994973</span></span>
<span id="cb20-43"><a href="#cb20-43" tabindex="-1"></a>      <span class="fu">sentimentr_sentiword</span>()  <span class="fl">1048.496476</span>  <span class="fl">1060.058681</span>  <span class="fl">1064.804513</span></span>
<span id="cb20-44"><a href="#cb20-44" tabindex="-1"></a>         <span class="fu">SentimentAnalysis</span>()  <span class="fl">4267.380620</span>  <span class="fl">4335.857740</span>  <span class="fl">4369.068442</span></span>
<span id="cb20-45"><a href="#cb20-45" tabindex="-1"></a>           <span class="fu">syuzhet_jockers</span>()   <span class="fl">342.764273</span>   <span class="fl">346.408800</span>   <span class="fl">349.115379</span></span>
<span id="cb20-46"><a href="#cb20-46" tabindex="-1"></a>              <span class="fu">syuzhet_binn</span>()   <span class="fl">258.453721</span>   <span class="fl">267.449255</span>   <span class="fl">271.441450</span></span>
<span id="cb20-47"><a href="#cb20-47" tabindex="-1"></a>               <span class="fu">syuzhet_nrc</span>()   <span class="fl">642.814135</span>   <span class="fl">648.150176</span>   <span class="fl">653.361347</span></span>
<span id="cb20-48"><a href="#cb20-48" tabindex="-1"></a>             <span class="fu">syuzhet_afinn</span>()   <span class="fl">118.191289</span>   <span class="fl">120.576642</span>   <span class="fl">122.294740</span></span>
<span id="cb20-49"><a href="#cb20-49" tabindex="-1"></a>                     <span class="fu">meanr</span>()     <span class="fl">1.172578</span>     <span class="fl">1.317333</span>     <span class="fl">1.795786</span></span>
<span id="cb20-50"><a href="#cb20-50" tabindex="-1"></a>       median          uq          max neval</span>
<span id="cb20-51"><a href="#cb20-51" tabindex="-1"></a> <span class="fl">20994.667381</span> <span class="fl">25510.33232</span> <span class="fl">30025.997269</span>     <span class="dv">3</span></span>
<span id="cb20-52"><a href="#cb20-52" tabindex="-1"></a>   <span class="fl">283.511045</span>   <span class="fl">286.27379</span>   <span class="fl">289.036528</span>     <span class="dv">3</span></span>
<span id="cb20-53"><a href="#cb20-53" tabindex="-1"></a>   <span class="fl">232.537703</span>   <span class="fl">240.31619</span>   <span class="fl">248.094669</span>     <span class="dv">3</span></span>
<span id="cb20-54"><a href="#cb20-54" tabindex="-1"></a>   <span class="fl">264.874245</span>   <span class="fl">265.27323</span>   <span class="fl">265.672214</span>     <span class="dv">3</span></span>
<span id="cb20-55"><a href="#cb20-55" tabindex="-1"></a>  <span class="fl">1071.620886</span>  <span class="fl">1072.95853</span>  <span class="fl">1074.296176</span>     <span class="dv">3</span></span>
<span id="cb20-56"><a href="#cb20-56" tabindex="-1"></a>  <span class="fl">4404.334860</span>  <span class="fl">4419.91235</span>  <span class="fl">4435.489845</span>     <span class="dv">3</span></span>
<span id="cb20-57"><a href="#cb20-57" tabindex="-1"></a>   <span class="fl">350.053327</span>   <span class="fl">352.29093</span>   <span class="fl">354.528537</span>     <span class="dv">3</span></span>
<span id="cb20-58"><a href="#cb20-58" tabindex="-1"></a>   <span class="fl">276.444790</span>   <span class="fl">277.93532</span>   <span class="fl">279.425840</span>     <span class="dv">3</span></span>
<span id="cb20-59"><a href="#cb20-59" tabindex="-1"></a>   <span class="fl">653.486217</span>   <span class="fl">658.63495</span>   <span class="fl">663.783689</span>     <span class="dv">3</span></span>
<span id="cb20-60"><a href="#cb20-60" tabindex="-1"></a>   <span class="fl">122.961995</span>   <span class="fl">124.34647</span>   <span class="fl">125.730937</span>     <span class="dv">3</span></span>
<span id="cb20-61"><a href="#cb20-61" tabindex="-1"></a>     <span class="fl">1.462088</span>     <span class="fl">2.10739</span>     <span class="fl">2.752692</span>     <span class="dv">3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparing-sentimentr-syuzhet-meanr-and-stanford">Comparing sentimentr, syuzhet, meanr, and Stanford<a class="anchor" aria-label="anchor" href="#comparing-sentimentr-syuzhet-meanr-and-stanford"></a>
</h2>
<p>The accuracy of an algorithm weighs heavily into the decision as to what approach to take in sentiment detection. I have selected algorithms/packages that stand out as fast and/or accurate to perform benchmarking on actual data. The <strong>syuzhet</strong> package provides multiple dictionaries with a general algorithm to compute sentiment scores. Likewise, <strong>sentimentr</strong> uses a general algorithm but uses the <strong>lexicon</strong> package’s dictionaries. <strong>syuzhet</strong> provides 4 dictionaries while <strong>sentimentr</strong> uses <strong>lexicon</strong>’s 9 dictionaries and can be extended easily other dictionaries including the 4 dictionaries from the <strong>syuzhet</strong> package. <strong>meanr</strong> is a very fast algorithm. The follow visualization provides the accuracy of these approaches in comparison to Stanford’s <strong>Java</strong> based implementation of sentiment detection. The visualization is generated from testing on three reviews data sets from Kotzias, Denil, De Freitas, &amp; Smyth (2015). These authors utilized the three 1000 element data sets from:</p>
<ul>
<li>amazon.com</li>
<li>imdb.com</li>
<li>yelp.com</li>
</ul>
<p>The data sets are hand scored as either positive or negative. The testing here uses <a href="https://en.wikipedia.org/wiki/Mean_Directional_Accuracy_(MDA)" class="external-link">Mean Directional Accuracy (MDA)</a> and merely matches the sign of the algorithm to the human coded output to determine accuracy rates.</p>
<ul>
<li>Kotzias, D., Denil, M., De Freitas, N., &amp; Smyth,P. (2015). <em>From group to individual labels using deep features</em>. Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining. 597-606. http://mdenil.com/media/papers/2015-deep-multi-instance-learning.pdf</li>
</ul>
<p><img src="reference/figures/comparisons_between_sentiment_detectors_b.png"></p>
<p>The bar graph on the left shows the accuracy rates for the various sentiment set-ups in the three review contexts. The rank plot on the right shows how the rankings for the methods varied across the three review contexts.</p>
<p>The take away here seems that, unsurprisingly, Stanford’s algorithm consistently outscores <strong>sentimentr</strong>, <strong>syuzhet</strong>, and <strong>meanr</strong>. The <strong>sentimentr</strong> approach loaded with the Jockers’ custom <strong>syuzhet</strong> dictionary is a top pick for speed and accuracy. In addition to Jockers’ custom dictionary the <code>bing</code> dictionary also performs well within both the <strong>syuzhet</strong> and <strong>sentimentr</strong> algorithms. Generally, the <strong>sentimentr</strong> algorithm out performs <strong>syuzhet</strong> when their dictionaries are comparable.</p>
<p>It is important to point out that this is a small sample data set that covers a narrow range of uses for sentiment detection. Jockers’ <strong>syuzhet</strong> was designed to be applied across book chunks and it is, to some extent, unfair to test it out of this context. Still this initial analysis provides a guide that may be of use for selecting the sentiment detection set up most applicable to the reader’s needs.</p>
<p>The reader may access the R script used to generate this visual via:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>testing <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"sentiment_testing/sentiment_testing.R"</span>, <span class="at">package =</span> <span class="st">"sentimentr"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">file.copy</span>(testing, <span class="fu">getwd</span>())</span></code></pre></div>
<p>In the figure below we compare raw table counts as a heat map, plotting the predicted values from the various algorithms on the x axis versus the human scored values on the y axis.</p>
<p><img src="reference/figures/comparisons_between_sentiment_detectors2.png"></p>
<p>Across all three contexts, notice that the Stanford coreNLP algorithm is better at:</p>
<ul>
<li>Detecting negative sentiment as negative</li>
<li>Discrimination (i.e., reducing neutral assignments)</li>
</ul>
<p>The Jockers, Bing, Hu &amp; Lu, and Afinn dictionaries all do well with regard to not assigning negative scores to positive statements, but perform less well in the reverse, often assigning positive scores to negative statements, though Jockers’ dictionary outperforms the others. We can now see that the reason for the NRC’s poorer performance in accuracy rate above is its inability to discriminate. The Sentiword dictionary does well at discriminating (like Stanford’s coreNLP) but lacks accuracy. We can deduce two things from this observation:</p>
<ol style="list-style-type: decimal">
<li>Larger dictionaries discriminate better (Sentiword [n = 20,093] vs. Hu &amp; Lu [n = 6,874])</li>
<li>The Sentiword dictionary may have words with reversed polarities</li>
</ol>
<p>A reworking of the Sentiword dictionary may yield better results for a dictionary lookup approach to sentiment detection, potentially, improving on discrimination and accuracy.</p>
<p>The reader may access the R script used to generate this visual via:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>testing2 <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">"sentiment_testing/raw_results.R"</span>, <span class="at">package =</span> <span class="st">"sentimentr"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">file.copy</span>(testing2, <span class="fu">getwd</span>())</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="text-highlighting">Text Highlighting<a class="anchor" aria-label="anchor" href="#text-highlighting"></a>
</h2>
<p>The user may wish to see the output from <code>sentiment_by</code> line by line with positive/negative sentences highlighted. The <code>highlight</code> function wraps a <code>sentiment_by</code> output to produces a highlighted HTML file (positive = green; negative = pink). Here we look at three random reviews from Hu and Liu’s (2004) Cannon G3 Camera Amazon product reviews.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>hu_liu_cannon_reviews <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>    <span class="fu">filter</span>(review_id <span class="sc">%in%</span> <span class="fu">sample</span>(<span class="fu">unique</span>(review_id), <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">review =</span> <span class="fu">get_sentences</span>(text)) <span class="sc">%$%</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>    <span class="fu">sentiment_by</span>(review, review_id) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>    <span class="fu">highlight</span>()</span></code></pre></div>
<p><img src="reference/figures/highlight.png"></p>
</div>
</div>
<div class="section level1">
<h1 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h1>
<p>You are welcome to:<br>
- submit suggestions and bug-reports at: <a href="https://github.com/trinker/sentimentr/issues" class="external-link uri">https://github.com/trinker/sentimentr/issues</a><br>
- send a pull request on: <a href="https://github.com/trinker/sentimentr/" class="external-link uri">https://github.com/trinker/sentimentr/</a><br>
- compose a friendly e-mail to: <a href="mailto:tyler.rinker@gmail.com" class="email">tyler.rinker@gmail.com</a></p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=sentimentr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/trinker/sentimentr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/trinker/sentimentr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing sentimentr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Tyler Rinker <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



<div class="additional-contributions">
<h2 data-toc-skip>Additional Contributions</h2>
<ul class="list-unstyled">
<li><p>Vignette created by Helen Guo</p></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Developed by Tyler Rinker. Vignette created by Helen Guo.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
