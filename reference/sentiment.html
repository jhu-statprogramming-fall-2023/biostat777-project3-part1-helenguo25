<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Approximate the sentiment (polarity) of text by sentence.  This function allows
the user to easily alter (add, change, replace) the default polarity an 
valence shifters dictionaries to suit the context dependent needs of a particular
data set.  See the polarity_dt and valence_shifters_dt arguments
for more information.  Other hyper-parameters may add additional fine tuned 
control of the algorithm that may boost performance in different contexts."><title>Polarity Score (Sentiment Analysis) — sentiment • sentimentr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Polarity Score (Sentiment Analysis) — sentiment"><meta property="og:description" content="Approximate the sentiment (polarity) of text by sentence.  This function allows
the user to easily alter (add, change, replace) the default polarity an 
valence shifters dictionaries to suit the context dependent needs of a particular
data set.  See the polarity_dt and valence_shifters_dt arguments
for more information.  Other hyper-parameters may add additional fine tuned 
control of the algorithm that may boost performance in different contexts."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sentimentr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Vignette.html">Vignette</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/trinker/sentimentr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Polarity Score (Sentiment Analysis)</h1>
      <small class="dont-index">Source: <a href="https://github.com/trinker/sentimentr/blob/HEAD/R/sentiment.R" class="external-link"><code>R/sentiment.R</code></a></small>
      <div class="d-none name"><code>sentiment.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Approximate the sentiment (polarity) of text by sentence.  This function allows
the user to easily alter (add, change, replace) the default polarity an 
valence shifters dictionaries to suit the context dependent needs of a particular
data set.  See the <code>polarity_dt</code> and <code>valence_shifters_dt</code> arguments
for more information.  Other hyper-parameters may add additional fine tuned 
control of the algorithm that may boost performance in different contexts.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sentiment</span><span class="op">(</span></span>
<span>  <span class="va">text.var</span>,</span>
<span>  polarity_dt <span class="op">=</span> <span class="fu">lexicon</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_jockers_rinker.html" class="external-link">hash_sentiment_jockers_rinker</a></span>,</span>
<span>  valence_shifters_dt <span class="op">=</span> <span class="fu">lexicon</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/lexicon/man/hash_valence_shifters.html" class="external-link">hash_valence_shifters</a></span>,</span>
<span>  hyphen <span class="op">=</span> <span class="st">""</span>,</span>
<span>  amplifier.weight <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  n.before <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  n.after <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  question.weight <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  adversative.weight <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  neutral.nonverb.like <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  missing_value <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  retention_regex <span class="op">=</span> <span class="st">"\\d:\\d|\\d\\s|[^[:alpha:]',;: ]"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>text.var</dt>
<dd><p>The text variable.  Can be a <code>get_sentences</code> object or
a raw character vector though <code>get_sentences</code> is preferred as it avoids
the repeated cost of doing sentence boundary disambiguation every time
<code>sentiment</code> is run.</p></dd>


<dt>polarity_dt</dt>
<dd><p>A <span class="pkg">data.table</span> of positive/negative words and
weights with x and y as column names.  The <span class="pkg">lexicon</span> package has several 
dictionaries that can be used, including:</p><ul><li><p><code><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_jockers_rinker.html" class="external-link">lexicon::hash_sentiment_jockers_rinker</a></code></p></li>
<li><p><code><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_jockers.html" class="external-link">lexicon::hash_sentiment_jockers</a></code></p></li>
<li><p><code><a href="https://rdrr.io/pkg/lexicon/man/emojis_sentiment.html" class="external-link">lexicon::emojis_sentiment</a></code></p></li>
<li><p><code><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_emojis.html" class="external-link">lexicon::hash_sentiment_emojis</a></code></p></li>
<li><p><code><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_huliu.html" class="external-link">lexicon::hash_sentiment_huliu</a></code></p></li>
<li><p><code><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_loughran_mcdonald.html" class="external-link">lexicon::hash_sentiment_loughran_mcdonald</a></code></p></li>
<li><p><code><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_nrc.html" class="external-link">lexicon::hash_sentiment_nrc</a></code></p></li>
<li><p><code><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_senticnet.html" class="external-link">lexicon::hash_sentiment_senticnet</a></code></p></li>
<li><p><code><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_sentiword.html" class="external-link">lexicon::hash_sentiment_sentiword</a></code></p></li>
<li><p><code><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_slangsd.html" class="external-link">lexicon::hash_sentiment_slangsd</a></code></p></li>
<li><p><code><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_socal_google.html" class="external-link">lexicon::hash_sentiment_socal_google</a></code></p></li>
</ul><p>Additionally, the 
<code>as_key</code> function can be used to make a sentiment frame suitable for
<code>polarity_dt</code>.  This takes a 2 column data.frame with the first column
being words and the second column being polarity values.  Note that as of 
version 1.0.0 <span class="pkg">sentimentr</span> switched from the Liu &amp; HU (2004) dictionary
as the default to Jocker's (2017) dictionary from the <span class="pkg">syuzhet</span> package.
Use <code><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_huliu.html" class="external-link">lexicon::hash_sentiment_huliu</a></code> to obtain the old behavior.</p></dd>


<dt>valence_shifters_dt</dt>
<dd><p>A <span class="pkg">data.table</span> of valence shifters that
can alter a polarized word's meaning and an integer key for negators (1),
amplifiers [intensifiers] (2), de-amplifiers [downtoners] (3) and adversative 
conjunctions (4) with x and y as column names.</p></dd>


<dt>hyphen</dt>
<dd><p>The character string to replace hyphens with.  Default replaces
with nothing so 'sugar-free' becomes 'sugarfree'.  Setting <code>hyphen = " "</code>
would result in a space between words (e.g., 'sugar free').  Typically use 
either " " or default "".</p></dd>


<dt>amplifier.weight</dt>
<dd><p>The weight to apply to amplifiers/de-amplifiers 
[intensifiers/downtoners] (values from 0 to 1).  This value will multiply the 
polarized terms by 1 + this value.</p></dd>


<dt>n.before</dt>
<dd><p>The number of words to consider as valence shifters before
the polarized word.  To consider the entire beginning portion of a sentence
use <code>n.before = Inf</code>.</p></dd>


<dt>n.after</dt>
<dd><p>The number of words to consider as valence shifters after
the polarized word.  To consider the entire ending portion of a sentence
use <code>n.after = Inf</code>.</p></dd>


<dt>question.weight</dt>
<dd><p>The weighting of questions (values from 0 to 1).
Default is 1.  A 0 corresponds with the belief that questions (pure questions)
are not polarized.  A weight may be applied based on the evidence that the
questions function with polarized sentiment.  In an opinion tasks such as a
course evalaution the questions are more likely polarized, not designed to
gain information.  On the other hand, in a setting with more natural dialogue,
the question is less likely polarized and is likely to function as a means
to gather information.</p></dd>


<dt>adversative.weight</dt>
<dd><p>The weight to give to adversative conjunctions or 
contrasting conjunctions (e.g., "but") that overrule the previous clause 
(Halliday &amp; Hasan, 2013).  Weighting a contrasting statement stems from the 
belief that the adversative conjunctions like "but", "however", and "although" 
amplify the current clause and/or down weight the prior clause.  If an 
adversative conjunction is located before the polarized word in the context 
cluster the cluster is up-weighted 1 + number of occurrences of the 
adversative conjunctions before the polarized word times the
weight given (\(1 + N_{adversative\,conjunctions} * z_2\) where \(z_2\) 
is the <code>adversative.weight</code>).  Conversely, an adversative conjunction 
found after the polarized word in a context cluster down weights the cluster 
1 - number of occurrences of the adversative conjunctions after the polarized 
word times the weight given (\(1 + N_{adversative\,conjunctions}*-1 * z_2\)).  
These are added to the deamplifier and amplifier weights and thus the down 
weight is constrained to -1 as the lower bound.  Set to zero to remove 
adversative conjunction weighting.</p></dd>


<dt>neutral.nonverb.like</dt>
<dd><p>logical.  If <code>TRUE</code>, and 'like' is found
in the <code>polarity_dt</code>, when the word 'like' is preceded by one of the 
following linking verbs: <code>"'s"</code>, <code>"was"</code>, <code>"is"</code>, <code>"has"</code>, 
<code>"am"</code>, <code>"are"</code>, <code>"'re"</code>, <code>"had"</code>, or <code>"been"</code> it is 
neutralized as this non-verb form of like is not likely polarized.  This is a 
poor man's part of speech tagger, maintaining the balance between speed and 
accuracy.  The word 'like', as a verb, tends to be polarized and is usually 
preceded by a noun or pronoun, not one of the linking verbs above.  This 
hyper parameter doesn't always yield improved results depending on the context 
of where the text data comes from.  For example, it is likely to be more 
useful in literary works, where like is often used in non-verb form, than 
product comments.  Use of this parameter will add compute time, this must be 
weighed against the need for accuracy and the likeliness that more accurate 
results will come from setting this argument to <code>TRUE</code>.</p></dd>


<dt>missing_value</dt>
<dd><p>A value to replace <code>NA</code>/<code>NaN</code> with.  Use
<code>NULL</code> to retain missing values.</p></dd>


<dt>retention_regex</dt>
<dd><p>A regex of what characters to keep.  All other 
characters will be removed.  Note that when this is used all text is lower 
case format.  Only adjust this parameter if you really understand how it is 
used.  Note that swapping the <code>\\p{L}</code> for <code>[^[:alpha:];:,\']</code> may 
retain more alpha letters but will likely decrease speed.  See examples below 
for how to test the need for <code>\\p{L}</code>.</p></dd>


<dt>...</dt>
<dd><p>Ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a <span class="pkg">data.table</span> of:</p><ul><li><p>element_id - The id number of the original vector passed to <code>sentiment</code></p></li>
<li><p>sentence_id - The id number of the sentences within each <code>element_id</code></p></li>
<li><p>word_count - Word count</p></li>
<li><p>sentiment - Sentiment/polarity score (note: sentiments less than zero is negative, 0 is neutral, and greater than zero positive polarity)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The equation used by the algorithm to assign value to polarity of
each sentence fist utilizes the sentiment dictionary to tag polarized words.  
Each paragraph
(\(p_i = \{s_1, s_2, ..., s_n\}\)) composed of
sentences, is broken into element sentences
(\(s_i,j = \{w_1, w_2, ..., w_n\}\)) where \(w\)
are the words within sentences.  Each sentence (\(s_j\)) is broken into a
an ordered bag of words.  Punctuation is removed with the exception of pause
punctuations (commas, colons, semicolons) which are considered a word within
the sentence.  I will denote pause words as \(cw\) (comma words) for
convenience.  We can represent these words as an i,j,k notation as
\(w_{i,j,k}\).  For example \(w_{3,2,5}\) would be the fifth word of the
second sentence of the third paragraph.  While I use the term paragraph this
merely represent a complete turn of talk.  For example t may be a cell level
response in a questionnaire composed of sentences.</p>
<p>The words in each sentence (\(w_{i,j,k}\)) are searched and compared to a
dictionary of polarized words (e.g., Jockers (2017) dictionary found in 
the <span class="pkg">lexicon</span> package).  Positive (\(w_{i,j,k}^{+}\)) and
 negative (\(w_{i,j,k}^{-}\)) words are tagged with a \(+1\) 
 and \(-1\) respectively.  I will denote polarized words as \(pw\) for 
 convenience. These will form a polar cluster (\(c_{i,j,l}\)) 
 which is a subset of the a sentence 
 (\(c_{i,j,l} \subseteq s_i,j \)).</p>
<p>The polarized context cluster (\(c_{i,j,l}\)) of words is pulled from around
the polarized word (\(pw\)) and defaults to 4 words before and two words
after \(pw\)) to be considered as valence shifters.  The cluster can be represented as
(\(c_{i,j,l} = \{pw_{i,j,k - nb}, ..., pw_{i,j,k} , ..., pw_{i,j,k - na}\}\)),
where \(nb\) &amp; \(na\) are the parameters <code>n.before</code> and <code>n.after</code>
set by the user.  The words in this polarized context cluster are tagged as
neutral (\(w_{i,j,k}^{0}\)), negator (\(w_{i,j,k}^{n}\)),
amplifier [intensifier]] (\(w_{i,j,k}^{a}\)), or de-amplifier
[downtoner] (\(w_{i,j,k}^{d}\)). Neutral words hold no value in 
the equation but do affect word count (\(n\)).  Each polarized word is then 
weighted (\(w\)) based on the weights from the <code>polarity_dt</code> argument 
and then further weighted by the function and number of the valence shifters 
directly surrounding the positive or negative word (\(pw\)).  Pause 
(\(cw\)) locations (punctuation that denotes a pause including commas, 
colons, and semicolons) are indexed and considered in calculating the upper 
and lower bounds in the polarized context cluster. This is because these marks 
indicate a change in thought and words prior are not necessarily connected 
with words after these punctuation marks.  The lower bound of the polarized 
context cluster is constrained to 
\(\max \{pw_{i,j,k - nb}, 1, \max \{cw_{i,j,k} &lt; pw_{i,j,k}\}\}\) and the upper bound is
constrained to \(\min \{pw_{i,j,k + na}, w_{i,jn}, \min \{cw_{i,j,k} &gt; pw_{i,j,k}\}\}\)
where \(w_{i,jn}\) is the number of words in the sentence.</p>
<p>The core value in the cluster, the polarized word is acted upon by valence
shifters. Amplifiers (intensifiers) increase the polarity by 1.8 (.8 is the default weight
(\(z\))).  Amplifiers (\(w_{i,j,k}^{a}\)) become de-amplifiers if the context
cluster contains an odd number of negators (\(w_{i,j,k}^{n}\)).  De-amplifiers
(downtoners) work to decrease the polarity.  Negation (\(w_{i,j,k}^{n}\)) acts on
amplifiers/de-amplifiers as discussed but also flip the sign of the polarized
word.  Negation is determined by raising -1 to the power of the number of
negators (\(w_{i,j,k}^{n}\)) + 2.  Simply, this is a result of a belief that two
negatives equal a positive, 3 negatives a negative and so on.</p>
<p>The adversative conjunctions (i.e., 'but', 'however', and 'although') also 
weight the context cluster.  A adversative conjunction before the polarized 
word (\(w_{adversative\,conjunction}, ..., w_{i, j, k}^{p}\)) up-weights 
the cluster by 
\(1 + z_2 * \{|w_{adversative\,conjunction}|, ..., w_{i, j, k}^{p}\}\) 
(.85 is the default weight (\(z_2\))).  An adversative conjunction after 
the polarized word down-weights the cluster by
\(1 + \{w_{i, j, k}^{p}, ..., |w_{adversative\,conjunction}| * -1\} * z_2\).  
The number of occurrences before and after the polarized word are multiplied by
1 and -1 respectively and then summed within context cluster.  It is this
value that is multiplied by the weight and added to 1. This
corresponds to the belief that an adversative conjunction makes the next 
clause of greater values while lowering the value placed on the prior clause.</p>
<p>The researcher may provide a weight \(z\) to be utilized with
amplifiers/de-amplifiers (default is .8; de-amplifier weight is constrained
to -1 lower bound).  Last, these weighted context clusters (\(c_{i,j,l}\)) are
summed (\(c'_{i,j}\)) and divided by the square root of the word count (\(\sqrt{w_{i,jn}}\)) yielding an <strong>unbounded
polarity score</strong> (\(\delta\)) for each sentence.</p>
<p>$$\delta=\frac{c'_{i,j}}{\sqrt{w_{i,jn}}}$$</p>
<p>Where:</p>
<p>$$c'_{i,j}=\sum{((1 + w_{amp} + w_{deamp})\cdot w_{i,j,k}^{p}(-1)^{2 + w_{neg}})}$$</p>
<p>$$w_{amp}= (w_{b} &gt; 1) + \sum{(w_{neg}\cdot (z \cdot w_{i,j,k}^{a}))}$$</p>
<p>$$w_{deamp} = \max(w_{deamp'}, -1)$$</p>
<p>$$w_{deamp'}= (w_{b} &lt; 1) + \sum{(z(- w_{neg}\cdot w_{i,j,k}^{a} + w_{i,j,k}^{d}))}$$</p>
<p>$$w_{b} = 1 + z_2 * w_{b'}$$</p>
<p>$$w_{b'} = \sum{\\(|w_{adversative\,conjunction}|, ..., w_{i, j, k}^{p}, w_{i, j, k}^{p}, ..., |w_{adversative\,conjunction}| * -1}\\)$$</p>
<p>$$w_{neg}= \left(\sum{w_{i,j,k}^{n}}\right) \bmod {2}$$</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The polarity score is dependent upon the polarity dictionary used.
This function defaults to a combined and augmented version of Jocker's (2017) 
[originally exported by the <span class="pkg">syuzhet</span> package] &amp; Rinker's augmented Hu &amp; Liu (2004) 
dictionaries in the <span class="pkg">lexicon</span> package, however, this may not be appropriate, for 
example, in the context of children in a classroom.  The user may (is 
encouraged) to provide/augment the dictionary (see the <code>as_key</code> 
function).  For instance the word "sick" in a high school setting may mean 
that something is good, whereas "sick" used by a typical adult indicates 
something is not right or negative connotation (<strong>deixis</strong>).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jockers, M. L. (2017). Syuzhet: Extract sentiment and plot arcs 
from text. Retrieved from https://github.com/mjockers/syuzhet</p>
<p>Hu, M., &amp; Liu, B. (2004). Mining opinion features in customer
reviews. National Conference on Artificial Intelligence.</p>
<p>Halliday, M. A. K. &amp; Hasan, R. (2013). Cohesion in English. New York, NY: Routledge.</p>
<p><a href="https://www.slideshare.net/jeffreybreen/r-by-example-mining-twitter-for" class="external-link">https://www.slideshare.net/jeffreybreen/r-by-example-mining-twitter-for</a></p>
<p><a href="http://hedonometer.org/papers.html" class="external-link">http://hedonometer.org/papers.html</a> Links to papers on hedonometrics</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Original URL: https://github.com/trestletech/Sermon-Sentiment-Analysis</p>
<p>Other sentiment functions: 
<code><a href="sentiment_by.html">sentiment_by</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">mytext</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="st">'do you like it?  But I hate really bad dogs'</span>,</span></span>
<span class="r-in"><span>   <span class="st">'I am the best friend.'</span>,</span></span>
<span class="r-in"><span>   <span class="st">"Do you really like it?  I'm not a fan"</span>,</span></span>
<span class="r-in"><span>   <span class="st">"It's like a tree."</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## works on a character vector but not the preferred method avoiding the </span></span></span>
<span class="r-in"><span><span class="co">## repeated cost of doing sentence boundary disambiguation every time </span></span></span>
<span class="r-in"><span><span class="co">## `sentiment` is run.  For small batches the loss is minimal.</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">sentiment</span><span class="op">(</span><span class="va">mytext</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## preferred method avoiding paying the cost </span></span></span>
<span class="r-in"><span><span class="va">mytext</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_sentences.html">get_sentences</a></span><span class="op">(</span><span class="va">mytext</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sentiment</span><span class="op">(</span><span class="va">mytext</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    element_id sentence_id word_count  sentiment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:          1           1          4  0.2500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:          1           2          6 -1.8677359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:          2           1          5  0.5813777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:          3           1          5  0.4024922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:          3           2          4  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:          4           1          4  0.0000000</span>
<span class="r-in"><span><span class="fu">sentiment</span><span class="op">(</span><span class="va">mytext</span>, question.weight <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    element_id sentence_id word_count  sentiment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:          1           1          4  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:          1           2          6 -1.8677359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:          2           1          5  0.5813777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:          3           1          5  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:          3           2          4  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:          4           1          4  0.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sam_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_sentences.html">get_sentences</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"Sam-I-am"</span>, <span class="st">"Sam I am"</span>, <span class="va">sam_i_am</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">sam</span> <span class="op">&lt;-</span> <span class="fu">sentiment</span><span class="op">(</span><span class="va">sam_dat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      element_id sentence_id word_count sentiment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:          1           1          3 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:          2           1          3 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:          3           1         NA 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:          4           1          4 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:          5           1          4 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 193:        165           2          5 0.2683282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 194:        166           1          4 0.2500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 195:        167           1          4 0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 196:        168           1          2 0.3535534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 197:        169           1          5 0.2236068</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sam</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sentiment-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sam</span>, scale_range <span class="op">=</span> <span class="cn">TRUE</span>, low_pass_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sentiment-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sam</span>, scale_range <span class="op">=</span> <span class="cn">TRUE</span>, low_pass_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sentiment-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">## legacy transform functions from suuzhet</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sam</span>, transformation.function <span class="op">=</span> <span class="fu">syuzhet</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/syuzhet/man/get_transformed_values.html" class="external-link">get_transformed_values</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sam</span>, transformation.function <span class="op">=</span> <span class="fu">syuzhet</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/syuzhet/man/get_transformed_values.html" class="external-link">get_transformed_values</a></span>,  </span></span>
<span class="r-in"><span>    scale_range <span class="op">=</span> <span class="cn">TRUE</span>, low_pass_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>This function is maintained for legacy purposes.  Consider using get_dct_transform() instead.</span>
<span class="r-plt img"><img src="sentiment-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_sentences.html">get_sentences</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"He was not the sort of man that one would describe as especially handsome."</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sentiment</span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    element_id sentence_id word_count sentiment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:          1           1         14 0.4810702</span>
<span class="r-in"><span><span class="fu">sentiment</span><span class="op">(</span><span class="va">y</span>, n.before<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    element_id sentence_id word_count     sentiment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:          1           1         14 -0.0002672612</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">## Categorize the polarity (tidyverse vs. data.table):</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sentiment</span><span class="op">(</span><span class="va">mytext</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>category <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="va">sentiment</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">'Negative'</span>, </span></span>
<span class="r-in"><span>        <span class="va">sentiment</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">'Neutral'</span>, </span></span>
<span class="r-in"><span>        <span class="va">sentiment</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">'Positive'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Negative'</span>, <span class="st">'Neutral'</span>, <span class="st">'Positive'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in sentiment(mytext) %&gt;% as_tibble() %&gt;% mutate(category = case_when(sentiment &lt;     0 ~ "Negative", sentiment == 0 ~ "Neutral", sentiment &gt; 0 ~     "Positive") %&gt;% factor(levels = c("Negative", "Neutral",     "Positive"))):</span> could not find function "%&gt;%"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu">sentiment</span><span class="op">(</span><span class="va">mytext</span><span class="op">)</span><span class="op">[</span>, <span class="va">category</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fcase.html" class="external-link">fcase</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="va">sentiment</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="st">'Negative'</span>, </span></span>
<span class="r-in"><span>        <span class="va">sentiment</span> <span class="op">==</span> <span class="fl">0</span>, <span class="st">'Neutral'</span>, </span></span>
<span class="r-in"><span>        <span class="va">sentiment</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">'Positive'</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Negative'</span>, <span class="st">'Neutral'</span>, <span class="st">'Positive'</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="op">]</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Invalid .internal.selfref detected and fixed by taking a (shallow) copy of the data.table so that := can add this new column by reference. At an earlier point, this data.table has been copied by R (or was created manually using structure() or similar). Avoid names&lt;- and attr&lt;- which in R currently (and oddly) may copy the whole data.table. Use set* syntax instead to avoid copying: ?set, ?setnames and ?setattr. If this message doesn't help, please report your use case to the data.table issue tracker so the root cause can be fixed or this message improved.</span>
<span class="r-in"><span><span class="va">dt</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    element_id sentence_id word_count  sentiment category</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:          1           1          4  0.2500000 Positive</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:          1           2          6 -1.8677359 Negative</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:          2           1          5  0.5813777 Positive</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:          3           1          5  0.4024922 Positive</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:          3           2          4  0.0000000  Neutral</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:          4           1          4  0.0000000  Neutral</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Person 1'</span>, <span class="st">'Person 2'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"Mr. Brown is nasty! He says hello. i give him rage.  i will "</span>,</span></span>
<span class="r-in"><span>        <span class="st">"go at 5 p. m. eastern time.  Angry thought in between!go there"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>, <span class="st">"One more thought for the road! I am going now.  Good day and good riddance."</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="va">state.name</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">32</span>, <span class="fl">38</span><span class="op">)</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>    z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.456</span>, <span class="fl">.124</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sentiment</span><span class="op">(</span><span class="fu"><a href="get_sentences.html">get_sentences</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    element_id sentence_id word_count  sentiment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:          1           1          4 -0.5000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:          1           2          3  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:          1           3          4 -0.5000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:          1           4          8  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:          1           5          4 -0.3750000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:          1           6          2  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7:          2           1          6  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8:          2           2          4  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9:          2           3          5  0.6708204</span>
<span class="r-in"><span><span class="fu">sentiment</span><span class="op">(</span><span class="fu"><a href="get_sentences.html">get_sentences</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           w                                 x            y     z element_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: Person 1               Mr. Brown is nasty!     New York 0.456          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: Person 1                    He says hello.     New York 0.456          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3: Person 1                  i give him rage.     New York 0.456          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4: Person 1 i will go at 5 p.m. eastern time.     New York 0.456          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5: Person 1         Angry thought in between!     New York 0.456          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6: Person 1                          go there     New York 0.456          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7: Person 2    One more thought for the road! Pennsylvania 0.124          2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8: Person 2                   I am going now. Pennsylvania 0.124          2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9: Person 2       Good day and good riddance. Pennsylvania 0.124          2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    sentence_id word_count  sentiment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:           1          4 -0.5000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:           2          3  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:           3          4 -0.5000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:           4          8  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:           5          4 -0.3750000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:           6          2  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7:           1          6  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8:           2          4  0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9:           3          5  0.6708204</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## tidy approach</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">hu_liu_cannon_reviews</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>review_split <span class="op">=</span> <span class="fu"><a href="get_sentences.html">get_sentences</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html" class="external-link">%$%</a></span></span></span>
<span class="r-in"><span>   <span class="fu">sentiment</span><span class="op">(</span><span class="va">review_split</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Emojis</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## Load R twitter data</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"docs/r_tweets.txt"</span>, package <span class="op">=</span> <span class="st">"textclean"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>; <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## There are 2 approaches</span></span></span>
<span class="r-in"><span><span class="co">## Approach 1: Replace with words</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Tweet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/textclean/man/replace_emoji.html" class="external-link">replace_emoji</a></span><span class="op">(</span><span class="va">Tweet</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html" class="external-link">%$%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">sentiment</span><span class="op">(</span><span class="va">Tweet</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Approach 2: Replace with identifier token</span></span></span>
<span class="r-in"><span><span class="va">combined_emoji</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_key.html">update_polarity_table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">lexicon</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_jockers_rinker.html" class="external-link">hash_sentiment_jockers_rinker</a></span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu">lexicon</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/lexicon/man/hash_sentiment_emojis.html" class="external-link">hash_sentiment_emojis</a></span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Tweet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/textclean/man/replace_emoji.html" class="external-link">replace_emoji_identifier</a></span><span class="op">(</span><span class="va">Tweet</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html" class="external-link">%$%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">sentiment</span><span class="op">(</span><span class="va">Tweet</span>, polarity_dt <span class="op">=</span> <span class="va">combined_emoji</span><span class="op">)</span></span></span>
<span class="r-in"><span>    </span></span>
<span class="r-in"><span><span class="co">## Use With Non-ASCII</span></span></span>
<span class="r-in"><span><span class="co">## Warning: sentimentr has not been tested with languages other than English.</span></span></span>
<span class="r-in"><span><span class="co">## The example below is how one might use sentimentr if you believe the </span></span></span>
<span class="r-in"><span><span class="co">## language you are working with are similar enough in grammar to for</span></span></span>
<span class="r-in"><span><span class="co">## sentimentr to be viable (likely Germanic languages)</span></span></span>
<span class="r-in"><span><span class="co">## english_sents &lt;- c(</span></span></span>
<span class="r-in"><span><span class="co">##     "I hate bad people.",</span></span></span>
<span class="r-in"><span><span class="co">##     "I like yummy cookie.",</span></span></span>
<span class="r-in"><span><span class="co">##     "I don't love you anymore; sorry."</span></span></span>
<span class="r-in"><span><span class="co">## )</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Roughly equivalent to the above English</span></span></span>
<span class="r-in"><span><span class="va">danish_sents</span> <span class="op">&lt;-</span> <span class="fu">stringi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stringi/man/stri_unescape_unicode.html" class="external-link">stri_unescape_unicode</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Jeg hader d\\u00e5rlige mennesker."</span>, </span></span>
<span class="r-in"><span>    <span class="st">"Jeg kan godt lide l\\u00e6kker is."</span>, </span></span>
<span class="r-in"><span>    <span class="st">"Jeg elsker dig ikke mere; undskyld."</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">danish_sents</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Polarity terms</span></span></span>
<span class="r-in"><span><span class="va">polterms</span> <span class="op">&lt;-</span> <span class="fu">stringi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stringi/man/stri_unescape_unicode.html" class="external-link">stri_unescape_unicode</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'hader'</span>, <span class="st">'d\\u00e5rlige'</span>, <span class="st">'undskyld'</span>, <span class="st">'l\\u00e6kker'</span>, <span class="st">'kan godt'</span>, <span class="st">'elsker'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Make polarity_dt</span></span></span>
<span class="r-in"><span><span class="va">danish_polarity</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_key.html">as_key</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu">stringi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stringi/man/stri_unescape_unicode.html" class="external-link">stri_unescape_unicode</a></span><span class="op">(</span><span class="va">polterms</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Make valence_shifters_dt</span></span></span>
<span class="r-in"><span><span class="va">danish_valence_shifters</span> <span class="op">&lt;-</span> <span class="fu"><a href="as_key.html">as_key</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">'ikke'</span>, y<span class="op">=</span><span class="st">"1"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>    sentiment <span class="op">=</span> <span class="cn">FALSE</span>, </span></span>
<span class="r-in"><span>    comparison <span class="op">=</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">sentiment</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">danish_sents</span>, </span></span>
<span class="r-in"><span>    polarity_dt <span class="op">=</span> <span class="va">danish_polarity</span>, </span></span>
<span class="r-in"><span>    valence_shifters_dt <span class="op">=</span> <span class="va">danish_valence_shifters</span>, </span></span>
<span class="r-in"><span>    retention_regex <span class="op">=</span> <span class="st">"\\d:\\d|\\d\\s|[^\\p{L}',;: ]"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A way to test if you need [:alpha:] vs \p{L} in `retention_regex`:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 1. Does it wreck some of the non-ascii characters by default?</span></span></span>
<span class="r-in"><span><span class="fu">sentimentr</span><span class="fu">:::</span><span class="fu">make_sentence_df2</span><span class="op">(</span><span class="va">danish_sents</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## 2.Does this?</span></span></span>
<span class="r-in"><span><span class="fu">sentimentr</span><span class="fu">:::</span><span class="fu">make_sentence_df2</span><span class="op">(</span><span class="va">danish_sents</span>, <span class="st">"\\d:\\d|\\d\\s|[^\\p{L}',;: ]"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## If you answer yes to #1 but no to #2 you likely want \p{L}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Developed by Tyler Rinker. Vignette created by Helen Guo.</p>
</div>

    </footer></div>

  

  

  </body></html>

